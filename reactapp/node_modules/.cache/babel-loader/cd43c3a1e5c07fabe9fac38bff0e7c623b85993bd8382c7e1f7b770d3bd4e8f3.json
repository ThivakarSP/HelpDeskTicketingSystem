{"ast":null,"code":"import React,{useState,useEffect}from'react';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const TicketDetails=_ref=>{let{ticketId,onStatusUpdate,onBack}=_ref;const[ticket,setTicket]=useState(null);const[loading,setLoading]=useState(true);const[error,setError]=useState(null);const[updating,setUpdating]=useState(false);useEffect(()=>{if(ticketId){fetchTicket();}},[ticketId]);const fetchTicket=async()=>{try{const response=await fetch(\"/api/tickets/\".concat(ticketId));if(!response.ok){throw new Error('Failed to fetch ticket');}const data=await response.json();setTicket(data);}catch(err){setError(err.message);}finally{setLoading(false);}};const updateStatus=async newStatus=>{setUpdating(true);try{const response=await fetch(\"/api/tickets/\".concat(ticketId,\"/status\"),{method:'PATCH',headers:{'Content-Type':'application/json'},body:JSON.stringify({status:newStatus})});if(!response.ok){throw new Error('Failed to update status');}const updatedTicket=await response.json();setTicket(updatedTicket);if(onStatusUpdate){onStatusUpdate(updatedTicket);}}catch(err){setError(err.message);}finally{setUpdating(false);}};const formatDate=dateString=>{return dateString?new Date(dateString).toLocaleString():'—';};const getStatusClass=status=>{return\"status-badge status-\".concat(status.toLowerCase());};const getPriorityClass=priority=>{return priority?\"priority-\".concat(priority.toLowerCase()):'';};const getAvailableStatuses=currentStatus=>{const allStatuses=['OPEN','IN_PROGRESS','RESOLVED','CLOSED'];// keep in sync with backend\nreturn allStatuses.filter(status=>status!==currentStatus);};if(loading)return/*#__PURE__*/_jsx(\"div\",{className:\"container\",children:\"Loading ticket...\"});if(error)return/*#__PURE__*/_jsxs(\"div\",{className:\"container\",children:[\"Error: \",error]});if(!ticket)return/*#__PURE__*/_jsx(\"div\",{className:\"container\",children:\"Ticket not found\"});return/*#__PURE__*/_jsxs(\"div\",{className:\"container\",children:[/*#__PURE__*/_jsx(\"div\",{style:{marginBottom:'1rem'},children:/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>onBack?onBack():window.location.href='/',className:\"btn-secondary\",children:\"\\u2190 Back to All Tickets\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"card\",children:[/*#__PURE__*/_jsx(\"h1\",{children:ticket.title}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',gap:'2rem',marginBottom:'1.5rem'},children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Status:\"}),\" \",/*#__PURE__*/_jsx(\"span\",{className:getStatusClass(ticket.status),children:ticket.status})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Priority:\"}),\" \",/*#__PURE__*/_jsx(\"span\",{className:getPriorityClass(ticket.priority),children:ticket.priority})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Category:\"}),\" \",ticket.category]})]}),/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:'1.5rem'},children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Description\"}),/*#__PURE__*/_jsx(\"p\",{style:{background:'#f8f9fa',padding:'1rem',borderRadius:'4px'},children:ticket.description})]}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',gap:'2rem',marginBottom:'1.5rem'},children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Submitter:\"}),\" \",ticket.submitter?ticket.submitter.username||ticket.submitter.id:'—']}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Assigned Agent:\"}),\" \",ticket.assignedAgent?ticket.assignedAgent.username||ticket.assignedAgent.id:'—']}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Created:\"}),\" \",formatDate(ticket.createdAt)]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Update Status\"}),/*#__PURE__*/_jsx(\"div\",{style:{display:'flex',gap:'0.5rem',flexWrap:'wrap'},children:getAvailableStatuses(ticket.status).map(status=>/*#__PURE__*/_jsx(\"button\",{className:\"btn-primary\",onClick:()=>updateStatus(status),disabled:updating,style:{opacity:updating?0.6:1,cursor:updating?'not-allowed':'pointer'},children:updating?'Updating...':\"Mark as \".concat(status.replace('_',' '))},status))})]})]})]});};export default TicketDetails;","map":{"version":3,"names":["React","useState","useEffect","jsx","_jsx","jsxs","_jsxs","TicketDetails","_ref","ticketId","onStatusUpdate","onBack","ticket","setTicket","loading","setLoading","error","setError","updating","setUpdating","fetchTicket","response","fetch","concat","ok","Error","data","json","err","message","updateStatus","newStatus","method","headers","body","JSON","stringify","status","updatedTicket","formatDate","dateString","Date","toLocaleString","getStatusClass","toLowerCase","getPriorityClass","priority","getAvailableStatuses","currentStatus","allStatuses","filter","className","children","style","marginBottom","type","onClick","window","location","href","title","display","gap","category","background","padding","borderRadius","description","submitter","username","id","assignedAgent","createdAt","flexWrap","map","disabled","opacity","cursor","replace"],"sources":["D:/Helpdesk_Ticketing/98698b33-5bdf-4501-9f43-41e3e1cbf16a-628b1e05-cb12-43d5-95c0-c4c48d574d3a/reactapp/src/components/TicketDetails.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\n\r\nconst TicketDetails = ({ ticketId, onStatusUpdate, onBack }) => {\r\n  const [ticket, setTicket] = useState(null);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState(null);\r\n  const [updating, setUpdating] = useState(false);\r\n\r\n  useEffect(() => {\r\n    if (ticketId) {\r\n      fetchTicket();\r\n    }\r\n  }, [ticketId]);\r\n\r\n  const fetchTicket = async () => {\r\n    try {\r\n      const response = await fetch(`/api/tickets/${ticketId}`);\r\n      if (!response.ok) {\r\n        throw new Error('Failed to fetch ticket');\r\n      }\r\n      const data = await response.json();\r\n      setTicket(data);\r\n    } catch (err) {\r\n      setError(err.message);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const updateStatus = async (newStatus) => {\r\n    setUpdating(true);\r\n    try {\r\n      const response = await fetch(`/api/tickets/${ticketId}/status`, {\r\n        method: 'PATCH',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n        },\r\n        body: JSON.stringify({ status: newStatus }),\r\n      });\r\n\r\n      if (!response.ok) {\r\n        throw new Error('Failed to update status');\r\n      }\r\n\r\n      const updatedTicket = await response.json();\r\n      setTicket(updatedTicket);\r\n      if (onStatusUpdate) {\r\n        onStatusUpdate(updatedTicket);\r\n      }\r\n    } catch (err) {\r\n      setError(err.message);\r\n    } finally {\r\n      setUpdating(false);\r\n    }\r\n  };\r\n\r\n  const formatDate = (dateString) => {\r\n    return dateString ? new Date(dateString).toLocaleString() : '—';\r\n  };\r\n\r\n  const getStatusClass = (status) => {\r\n    return `status-badge status-${status.toLowerCase()}`;\r\n  };\r\n\r\n  const getPriorityClass = (priority) => {\r\n    return priority ? `priority-${priority.toLowerCase()}` : '';\r\n  };\r\n\r\n  const getAvailableStatuses = (currentStatus) => {\r\n    const allStatuses = ['OPEN', 'IN_PROGRESS', 'RESOLVED', 'CLOSED']; // keep in sync with backend\r\n    return allStatuses.filter(status => status !== currentStatus);\r\n  };\r\n\r\n  if (loading) return <div className=\"container\">Loading ticket...</div>;\r\n  if (error) return <div className=\"container\">Error: {error}</div>;\r\n  if (!ticket) return <div className=\"container\">Ticket not found</div>;\r\n\r\n  return (\r\n    <div className=\"container\">\r\n      <div style={{ marginBottom: '1rem' }}>\r\n  <button type=\"button\" onClick={() => (onBack ? onBack() : (window.location.href = '/'))} className=\"btn-secondary\">← Back to All Tickets</button>\r\n      </div>\r\n      \r\n      <div className=\"card\">\r\n        <h1>{ticket.title}</h1>\r\n        \r\n        <div style={{ display: 'flex', gap: '2rem', marginBottom: '1.5rem' }}>\r\n          <div>\r\n            <strong>Status:</strong> <span className={getStatusClass(ticket.status)}>{ticket.status}</span>\r\n          </div>\r\n          <div>\r\n            <strong>Priority:</strong> <span className={getPriorityClass(ticket.priority)}>{ticket.priority}</span>\r\n          </div>\r\n          <div>\r\n            <strong>Category:</strong> {ticket.category}\r\n          </div>\r\n        </div>\r\n\r\n        <div style={{ marginBottom: '1.5rem' }}>\r\n          <h3>Description</h3>\r\n          <p style={{ background: '#f8f9fa', padding: '1rem', borderRadius: '4px' }}>\r\n            {ticket.description}\r\n          </p>\r\n        </div>\r\n\r\n        <div style={{ display: 'flex', gap: '2rem', marginBottom: '1.5rem' }}>\r\n          <div>\r\n            <strong>Submitter:</strong> {ticket.submitter ? (ticket.submitter.username || ticket.submitter.id) : '—'}\r\n          </div>\r\n          <div>\r\n            <strong>Assigned Agent:</strong> {ticket.assignedAgent ? (ticket.assignedAgent.username || ticket.assignedAgent.id) : '—'}\r\n          </div>\r\n          <div>\r\n            <strong>Created:</strong> {formatDate(ticket.createdAt)}\r\n          </div>\r\n        </div>\r\n\r\n        <div>\r\n          <h3>Update Status</h3>\r\n          <div style={{ display: 'flex', gap: '0.5rem', flexWrap: 'wrap' }}>\r\n            {getAvailableStatuses(ticket.status).map(status => (\r\n              <button\r\n                key={status}\r\n                className=\"btn-primary\"\r\n                onClick={() => updateStatus(status)}\r\n                disabled={updating}\r\n                style={{ \r\n                  opacity: updating ? 0.6 : 1,\r\n                  cursor: updating ? 'not-allowed' : 'pointer'\r\n                }}\r\n              >\r\n                {updating ? 'Updating...' : `Mark as ${status.replace('_', ' ')}`}\r\n              </button>\r\n            ))}\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default TicketDetails;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}